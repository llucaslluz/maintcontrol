<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="/images/V-sem-fundo.png" type="image/png">
  <title>Detalhes do Chamado - MaintControl</title>

  <!-- Estilos -->
  <link rel="stylesheet" href="/css/sidebar.css" />
  <link rel="stylesheet" href="/css/detalhesChamado.css" />
  <link rel="stylesheet" href="/css/anexoModal.css" />

  <!-- Scripts -->
  <script defer src="/js/sidebar.js"></script>
  <script defer src="/js/anexoModal.js"></script>
  <script defer src="/js/mobileMenu.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>

</head>
<body>

  <!-- üî∑ SIDEBAR -->
  <aside class="sidebar">
    <div class="logo-box">
      <img src="/images/Voith-sem-fundo.png" alt="Logo" class="logo-img" />
      <span class="logo-text">MaintControl</span>
    </div>

    <div class="menu-container">
<nav class="menu-superior">

  <!-- DASHBOARD (sem submenu) -->
<a data-dashboard-link href="#">
  <i data-lucide="layout-dashboard"></i> Dashboard
</a>

  <!-- CHAMADOS -->
  <div class="menu-dropdown">
    <div class="menu-title"><i data-lucide="file-text"></i> Chamados</div>
    <div class="mobile-dropdown-trigger" data-menu="menu-chamados" title="Chamados">
      <i data-lucide="file-text"></i>
    </div>
    <div class="submenu" id="menu-chamados">
      <a href="/AbrirChamadoUsuario.html">Abrir Chamado</a>
      <a href="/ListagemChamados.html">Lista de Chamados</a>
    </div>
  </div>

  <!-- MAPAS -->
  <div class="menu-dropdown">
    <div class="menu-title"><i data-lucide="map"></i> Mapas</div>
    <div class="mobile-dropdown-trigger" data-menu="menu-mapas" title="Mapas">
      <i data-lucide="map"></i>
    </div>
    <div class="submenu" id="menu-mapas">
      <a href="/Mapa.html">Mapas</a>
      <a href="/MapaMaquinas.html">M√°quinas</a>
      <a href="/MapaCaldeiraria.html">Caldeiraria</a>
      <a href="/MapaFabricaEletrica.html">F√°brica El√©trica</a>
      <a href="/MapaPontes.html">Pontes / P√≥rticos</a>
    </div>
  </div>

  <!-- GEST√ÉO -->
  <div class="menu-dropdown">
    <div class="menu-title"><i data-lucide="settings"></i> Gest√£o</div>
    <div class="mobile-dropdown-trigger" data-menu="menu-gestao" title="Gest√£o">
      <i data-lucide="settings"></i>
    </div>
    <div class="submenu" id="menu-gestao">
      <a href="/GestaoUsuarios.html">Usu√°rios</a>
      <a href="/GestaoPermissoes.html">Permiss√µes</a>
      <a href="/GestaoLocais.html">Locais / Setores</a>
      <a href="/GestaoTipoManutencao.html">Tipos de Manuten√ß√£o</a>
      <a href="/GestaoCategoriaUsuario.html">Categorias de Usu√°rio</a>
      <a href="/GestaoMaquinasDispositivos.html">M√°quinas e Dispositivos</a>
    </div>
  </div>

  <!-- RELAT√ìRIOS -->
  <div class="menu-dropdown">
    <div class="menu-title"><i data-lucide="bar-chart-2"></i> Relat√≥rios</div>
    <div class="mobile-dropdown-trigger" data-menu="menu-relatorios" title="Relat√≥rios">
      <i data-lucide="bar-chart-2"></i>
    </div>
    <div class="submenu" id="menu-relatorios">
      <a href="/RelatoriosExportacoes.html">Relat√≥rios e Exporta√ß√µes</a>
      <a href="/HistoricoAuditoria.html">Hist√≥rico e Auditoria</a>
    </div>
  </div>

  <!-- PERFIL -->
  <a href="/Perfil.html">
    <i data-lucide="user"></i> Meu Perfil
  </a>

</nav>


      <div class="menu-inferior">
        <hr />
        <a href="../index.html" class="sair-link"><i data-lucide="log-out"></i> Sair</a>
      </div>
    </div>
  </aside>

  <!-- üî∂ CONTE√öDO -->
<main class="conteudo">
  <h1>Detalhes do Chamado</h1>

  <!-- üîπ Cabe√ßalho fixo com informa√ß√µes principais -->
  <section class="bloco-cabecalho">
    <div class="linha-info">
      <p><strong>ID:</strong> <span id="det-id">#‚Äî</span></p>
      <p><strong>Status:</strong> <span id="det-status" class="chip-status">‚Äî</span></p>
      <p><strong>Prioridade:</strong> <span id="det-prioridade" class="chip-prioridade">‚Äî</span></p>
    </div>
    <div class="linha-info">
      <p><strong>Local:</strong> <span id="det-local">‚Äî</span></p>
      <p><strong>M√°quina:</strong> <span id="det-maquina">‚Äî</span></p>
    </div>
    <div class="linha-info">
      <p><strong>Solicitante:</strong> <span id="det-solicitante">‚Äî</span></p>
      <p><strong>Data de Abertura:</strong> <span id="det-abertura">‚Äî</span></p>
      <p><strong>Data de Fechamento:</strong> <span id="det-fechamento">‚Äî</span></p>
    </div>
  </section>

  <!-- üîπ Descri√ß√£o do problema -->
  <section class="info-bloco">
    <h2>Descri√ß√£o do Problema</h2>
    <p id="det-descricao">‚Äî</p>
  </section>

  <!-- üîπ Hist√≥rico e T√©cnicos -->
  <section class="duas-colunas">
    <div class="info-bloco">
      <h2>Hist√≥rico do Servi√ßo</h2>
      <ul id="lista-historico" class="historico">
        <li>Sem hist√≥rico.</li>
      </ul>
      <button id="btn-adicionar-nota">‚ûï Adicionar Nota</button>
    </div>

    <div class="info-bloco">
      <h2>T√©cnicos em Atendimento</h2>
      <table class="tabela-tecnicos">
        <thead>
          <tr>
            <th>Nome</th>
            <th>Fun√ß√£o</th>
            <th>In√≠cio</th>
            <th>Fim</th>
          </tr>
        </thead>
        <tbody id="tabela-tecnicos-body">
          <tr><td colspan="4">Nenhum t√©cnico em atendimento.</td></tr>
        </tbody>
      </table>
      <button id="btn-adicionar-tecnico">üë∑ Adicionar T√©cnico</button>
    </div>
  </section>

  <!-- üîπ Solu√ß√£o do problema -->
  <section class="info-bloco">
    <h2>Solu√ß√£o do Problema</h2>
    <p id="det-solucao">A solu√ß√£o ser√° exibida quando o chamado for finalizado.</p>
  </section>

  <!-- üîπ Pend√™ncias -->
  <section class="info-bloco">
    <h2>Pend√™ncias</h2>
    <ul id="lista-pendencias" class="lista-pendencias">
      <li>Sem pend√™ncias registradas.</li>
    </ul>
    <button id="btn-adicionar-pendencia">‚ö†Ô∏è Adicionar Pend√™ncia</button>
  </section>

  <!-- üîπ Anexos -->
  <section class="info-bloco">
    <h2>Anexos</h2>
    <div id="lista-anexos" class="lista-anexos">
      <p>Nenhum anexo enviado.</p>
    </div>
    <button id="btn-anexar">üìé Anexar Arquivo</button>
  </section>

  <!-- üîπ Barra de a√ß√µes -->
  <section class="barra-acoes">
    <button id="btn-atender">üõ†Ô∏è Atender Chamado</button>
    <button id="btn-finalizar">‚úîÔ∏è Finalizar Chamado</button>
    <button id="btn-add-tecnico">üë∑ Adicionar T√©cnico</button>
    <button id="btn-pendencia">‚ö†Ô∏è Criar Pend√™ncia</button>
    <button id="btn-anexo">üìé Anexar</button>
  </section>

  <!-- MODAL: Adicionar T√©cnico -->
<div id="modal-add-tecnico" class="mc-modal" hidden>
  <div class="mc-modal-card">
    <div class="mc-modal-head">
      <h3>Adicionar T√©cnico ao Chamado</h3>
      <button class="mc-x" data-close-modal="modal-add-tecnico">‚úñ</button>
    </div>

    <div class="mc-modal-body">
      <label class="mc-label">Buscar t√©cnico (nome ou chapa)</label>
      <input id="inp-busca-tecnico" type="text" class="mc-input" placeholder="Ex.: Jo√£o, 123456" />

      <ul id="lista-resultados-tecnico" class="mc-result-list">
        <!-- resultados da busca -->
      </ul>

      <div class="mc-row">
        <div class="mc-col">
          <label class="mc-label">Hora de in√≠cio</label>
          <input id="inp-hora-inicio" type="datetime-local" class="mc-input" />
        </div>
        <div class="mc-col">
          <label class="mc-label">Observa√ß√£o (opcional)</label>
          <input id="inp-obs-inicio" type="text" class="mc-input" placeholder="Ex.: In√≠cio por inclus√£o manual" />
        </div>
      </div>
    </div>

    <div class="mc-modal-foot">
      <button class="mc-btn-sec" data-close-modal="modal-add-tecnico">Cancelar</button>
      <button id="btn-confirmar-add-tecnico" class="mc-btn-pri" disabled>Adicionar</button>
    </div>
  </div>
</div>

<!-- MODAL: Encerrar atendimento de um t√©cnico -->
<div id="modal-end-tecnico" class="mc-modal" hidden>
  <div class="mc-modal-card">
    <div class="mc-modal-head">
      <h3>Encerrar Atendimento</h3>
      <button class="mc-x" data-close-modal="modal-end-tecnico">‚úñ</button>
    </div>

    <div class="mc-modal-body">
      <p id="end-tec-info" class="mc-info">‚Äî</p>
      <label class="mc-label">Hora de t√©rmino</label>
      <input id="inp-hora-fim" type="datetime-local" class="mc-input" />
      <p class="mc-tip">Dica: a hora de t√©rmino deve ser maior que a hora de in√≠cio.</p>
    </div>

    <div class="mc-modal-foot">
      <button class="mc-btn-sec" data-close-modal="modal-end-tecnico">Cancelar</button>
      <button id="btn-confirmar-end-tecnico" class="mc-btn-pri">Encerrar</button>
    </div>
  </div>
</div>

</main>


  <!-- √çcones lucide -->
  <script>
    lucide.createIcons();
  </script>


<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script src="/js/supabaseClient.js"></script>
<script src="/js/detalhesChamado.js"></script>


</body>
</html>
