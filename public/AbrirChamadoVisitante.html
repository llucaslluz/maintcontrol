<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="/images/V-sem-fundo.png" type="image/png">
  <title>Abrir Chamado - Visitante</title>

  <!-- Estilos (mantidos) -->
  <link rel="stylesheet" href="/css/abrirChamadoVisitante.css">
  <link rel="stylesheet" href="/css/anexoModal.css">

  <!-- Ícones -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- Supabase (carregar ANTES do JS da página!) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <!-- ATENÇÃO ao caminho e caixa: use /js/ e não /JS/ -->
  <script defer src="/js/supabaseClient.js"></script>

  <!-- Scripts da página (depois do supabaseClient) -->
  <script defer src="/js/abrirChamadoVistante.js"></script>
  <script defer src="/js/anexoModal.js"></script>
</head>
<body>

  <div class="chamado-box">
    <a href="/index.html" class="voltar-btn">Voltar</a>
    <img src="/images/Voith-sem-fundo.png" alt="Logo" class="logo">
    <h2>Abertura de Chamado</h2>

    <!-- ⚠️ Padronizei o ID do form para o mesmo usado na outra página -->
    <form id="formChamado">

      <fieldset>
        <legend>Identificação</legend>

        <label for="nome">Nome:</label>
        <input type="text" id="nome" required>

        <label for="chapa">Chapa:</label>
        <input type="text" id="chapa" required>

        <label for="funcao">Função/Cargo:</label>
        <input type="text" id="funcao" required>
      </fieldset>

      <fieldset>
        <legend>Detalhes do Chamado</legend>

        <label for="local">Local:</label>
        <select id="local" required>
          <option value="">Selecione</option>
        </select>

        <label for="maquina">Máquina:</label>
        <select id="maquina" required>
          <option value="">Selecione</option>
        </select>

        <label for="tipo">Tipo de Manutenção:</label>
        <select id="tipo" required>
          <option value="">Selecione</option>
        </select>

        <!-- Mesmo conjunto de valores da página do Usuário -->
        <label for="status">Status da Máquina:</label>
        <select id="status" required>
          <option value="">Selecione</option>
          <option value="Parada">Parada</option>
          <option value="Em Operação">Em Operação</option>
          <option value="Em Preparação">Em Preparação</option>
          <option value="Em Manutenção">Em Manutenção</option>
        </select>

        <!-- Mesmo conjunto (valores minúsculos) -->
        <label for="prioridade">Prioridade:</label>
        <select id="prioridade" required>
          <option value="alta">Alta</option>
          <option value="media">Média</option>
          <option value="baixa">Baixa</option>
        </select>

        <label for="descricao">Descrição do Problema:</label>
        <textarea id="descricao" rows="4" required></textarea>

        <!-- Botão / Modal de Anexo (mantidos; upload desativado no JS) -->
        <button type="button" id="botao-anexo" class="botao-anexo" onclick="abrirAnexo()">
          <i data-lucide="paperclip" style="width:16px;height:16px;"></i> Anexar
        </button>

        <div id="anexo" class="anexo-modal">
          <h2>Anexar Arquivos</h2>
          <p>Selecione um ou mais arquivos (imagens, PDF, vídeos).</p>

          <input type="file" id="arquivo" multiple accept="image/*,.pdf,.mp4" onchange="mostrarNomeArquivos()" />
          <ul id="lista-arquivos" style="font-size:14px;margin-top:8px;color:#333;padding-left:18px;"></ul>

          <br>
          <button type="button">
            <i data-lucide="upload" style="width:16px;height:16px;"></i> Enviar
          </button>
          <button type="button" onclick="fecharAnexo()">❌ Cancelar</button>
        </div>
      </fieldset>

      <button type="submit">Abrir Chamado</button>

      <p class="importante">
        ⚠️ Ao abrir este chamado, uma solicitação de cadastro também será enviada para o supervisor.
      </p>

      <div class="links-uteis">
        <a href="#">Página de Ajuda</a> |
        <a href="#">Contato</a> |
        <a href="#">FAQ</a>
      </div>
    </form>

    <footer>
      <p>by <br><strong>Lucas Luz</strong></p>
    </footer>
  </div>

  <script> lucide.createIcons(); </script>
</body>
</html>
